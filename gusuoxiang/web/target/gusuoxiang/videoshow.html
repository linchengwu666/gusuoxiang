<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="css/conmom.css">
    <link rel="stylesheet" href="css/videoshow.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/font-awesome.css"/>
</head>
<body>
    <div class="videoshow-bg">
        <div class="nav relative">
            <div class="search-box inb absolute">
                <input type="text" placeholder="搜你所要"><i class="inb .icon-search"></i>
            </div>
            <div class="stu-shop inb absolute">
                <div class="study inb">我的学习</div>
                <div class="shop inb">购物车</div>
            </div>
            <div class="admin">
                <span class="inb absolute" id="myname">MyNane</span>
                <img class="absolute" src="img/touxiang.png" alt="">
            </div>
        </div>

        <div class="vdtitle absolute">
            <h1 id="tt">看哭了，王教授教你如何防止脱发</h1>
            <p>作者：<i id="id">老王</i>视频播放量：<i id="bfl">1124</i>推荐指数：<i id="zs" class="icon-brightness-up"></i></p>
            <a href="main.html"><span class="absolute">返回主页</span></a>
        </div>

        <div class="video relative">
            <div class="player">
                <video id="tv" src="./video/fun.mp4"></video>
                <div class="controls">
                    <!--播放/暂停-->
                    <a href="javascript:;" class="switch fa fa-play"></a>
                    <!--播放进度-->
                    <div class="progress">
                        <div class="line"></div>
                        <div class="bar"></div>
                    </div>
                    <!--当前播放时间/播放总时长-->
                    <div class="timer">
                        <span class="current">00:00:00</span> / <span class="total">00:00:00</span>
                    </div>
                    <!--全屏/取消全屏-->
                    <a href="javascript:;" class="expand fa fa-arrows-alt"></a>
                </div>
            </div>
        
        </div>


        <div class="menu relative">
            <ul>
                <li> 收藏<i class="icon-cheveron-outline-up"></i> </li>
                <li>墙裂推荐</li>
                <li>有点帮助</li>
                <li>我觉得不行</li>
            </ul>

            <span class="absolute">保存并上传</span>
        </div>



        <div class="note relative">
            <div class="n-ele">
                <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div>
            </div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
            <div class="n-ele"> <div class="e-show relative">
                    <img src="img/touxiang.png" alt="">
                    <h1 class="absolute">@王老喃喃</h1>
                    <h2 class="absolute" >赞成：<i>1111</i></h2>
                    <h3 class="absolute">反对：<i>333</i></h3>

                </div></div>
           
        </div>
    </div>


    <script src="js/jquery.js"></script>
    <script>

        window.onload = function () {

      
        // 这些方法、属性和事件允许您使用 JavaScript 来操作 <audio> 和 <video> 元素
        // 这些api 是原生js dom的操作 我们如果使用jquery 千万别忘了转换
        // 获取元素
          var video = $("video").get(0);  // 把jquery 对象转换为 dom对象
    
    
          // 计算时分秒函数
           function formatTime(time) {
    
               // 计算小时
               // 我们有总的秒 数  计算 小时
               // 1小时 60 * 60  ==  3600 
               // 4000 / 3600  = 1
               var h = Math.floor(time / 3600);
                // 计算 分数
               // 我们有总的秒 数  计算 分数
               // 
               // 4000 % 3600   = 400 / 60 
               var m = Math.floor( time % 3600 / 60);
               var s = Math.floor(time % 60);
               // 00:00:00
               return (h<10 ? "0" + h : h) + ":" + (m<10 ? "0" + m : m) + ":" + (s<10 ? "0" + s : s); 
    
           }
        // 1. 当我们浏览器可以播放视频的时候，就让video 显示出来  让我们的时间显示出来
           video.oncanplay = function() { // oncanplay 是 video 原生事件 所以用 video dom对象
                // oncanplay浏览器可以播放视频
                $("video").show();  // show 是jquery 方法 所以要用 jquery对象调用
    
                // 我们怎么得到视频的长度呢时间
                // duration 是视频属性 H5  返回视频的长度 要用原生的dom对象调用
                 //console.log(video.duration);  164.815238 有小数
                 
                 var totalTime = formatTime(video.duration);
                 console.log(totalTime);
                 // 让我们总的时长的盒字放入 总时长
                 $(".total").html(totalTime);
           }
    
        // 2. 播放和暂停按钮
        // 当我们点击按钮，如果有 fa-play  这个 我们就切换为 fa-pause   并且播放
           $(".switch").on("click", function() {
            // 
                if($(this).hasClass("fa-play")) {  // 播放
                  video.play();  // play 视频的方法  需要用dom  播放视频
    
                  $(this).addClass('fa-pause').removeClass("fa-play");  // 切换图标
              }  else {  // 暂停
                    video.pause();  // pause 视频的方法  需要用dom  播放视频
    
                  $(this).addClass("fa-play").removeClass('fa-pause');  // 切换图标
              }
           })
    
        // 3. 进度条显示   当目前的播放位置已更改时
        //  除了自己进行之外， 只要我们修改了 video.currentTime  就会执行 ontimeupdate
           video.ontimeupdate = function() {
               // console.log(11);
               // 我们需要知道当前的时间
               // console.log(video.currentTime); 得到是秒数
               // line 这个变色的盒子 宽度 =  当前的时间 / 总的时间  * 100 + % 
               var w = video.currentTime / video.duration * 100 + "%";
               console.log(w)
               $(".line").css("width", w);
               // 4.显示我们的当前时间 
              $(".current").html(formatTime(video.currentTime));
           }
         // 5. 全屏显示  fa-compress   fa-arrows-alt
    
            $(".expand").on("click", function() {
            // 
                if($(this).hasClass("fa-arrows-alt")) {  // 播放
                  
                  video.webkitRequestFullScreen();  // 全屏显示   
                  $(this).addClass('fa-compress').removeClass("fa-arrows-alt");  // 切换图标
              }  else {  
                   
                 document.webkitCancelFullScreen();  // 取消 全屏显示  跟元素无关 跟document有关系 
                  $(this).addClass("fa-arrows-alt").removeClass('fa-compress');  // 切换图标
              }
           })
    
    
            // 6. 视频完成之后，重置操作
            // 视频播放完毕 用 onended 事件
            video.onended = function () {
                 // 当前的视频时间清零 
                 video.currentTime = 0;
                 // 同时还要把 播放按钮改为 play
                 $(".switch").addClass("fa-play").removeClass('fa-pause');
            }
             
            // 7.  点击 bar 跃进效果 
            // 
            $(".bar").on("click", function(event) {
                // 点击的位置 /  bar 的长度 * 总的时长  =  当前视频的播放位置
                // 1. 点击 位置
                var offset = event.offsetX;
                // console.log(offset);
                // 2. 当前点击视频的播放位置  当前的时间
                var current = offset / $(this).width() * video.duration;
                console.log(current);  
    
                // 3. 把当前的时间 给 currentTime 
                video.currentTime = current; 
            })




            // 获取传过来的参数

            function GetQueryString(name){
            var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);//search,查询？后面的参数，并匹配正则
            if(r!=null)return  unescape(r[2]); 
            return null;
            }
 
            // 调用方法
            var url = decodeURIComponent(GetQueryString("url")); // 获取视频地址
            var title = decodeURIComponent(GetQueryString("title"));  // 获取视频名称
            var number = decodeURIComponent(GetQueryString("number")); // 获取视频学习人数
            console.log(url + title + number);
            var tt = document.getElementById("tt");  // 获取标题
            var bfl = document.getElementById("bfl"); // 获取播放狼
            var tv = document.getElementById("tv"); // 获取视频地址
            // 设置获取到的参数
            tv.src = url + "";
            tt.innerText = title;
            bfl.innerText = number;




        }





                
    </script>
</body>
</html>